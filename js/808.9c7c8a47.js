"use strict";(self["webpackChunkdesigner"]=self["webpackChunkdesigner"]||[]).push([[808],{6808:(t,e,s)=>{s.r(e),s.d(e,{default:()=>g});var i=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"group"},[2!=t.user.role?e("div",{staticClass:"group_head"},[e("div",[t._v(t._s(t.lang.tips8)+" ("+t._s(t.group.length)+")")]),e("el-button",{staticStyle:{background:"#345CA0","border-radius":"12px",padding:"15px 24px","border-width":"0px"},attrs:{type:"primary",size:"small",icon:"el-icon-plus",disabled:t.isButtonDisabled},on:{click:t.addProject}},[t._v(" "+t._s(t.lang.add)+" ")])],1):t._e(),e("div",{staticClass:"group_item"},[0==t.group.length?e("div",{staticClass:"nodata"},[e("el-empty",{attrs:{description:t.lang.nodata}})],1):t._e(),t._l(t.group,(function(s){return e("div",{key:s.id,staticClass:"box"},[e("div",{staticClass:"main",on:{click:function(e){return t.goProject(s.id)}}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:s.loading,expression:"item.loading"}],staticClass:"cover",attrs:{"element-loading-text":t.lang.loading+"..."}},[e("img",{staticClass:"project_cover",attrs:{src:"https://www.simplerevise.com/img/project/v2/thumbnail/"+s.cover+".jpg",alt:""}})])]),e("div",{staticClass:"title"},[e("div",{staticClass:"action"},[e("i",{staticClass:"el-icon-share",on:{click:function(e){return t.share(s.id)}}}),s.creater_id==t.user.id||0==t.user.role?e("i",{staticClass:"el-icon-edit",on:{click:function(e){return t.rename(s.id)}}}):t._e(),s.creater_id==t.user.id||0==t.user.role?e("i",{staticClass:"el-icon-delete",on:{click:function(e){return t.del(s.id)}}}):t._e()]),e("p",[t._v(t._s(s.group_name))]),e("p",[t._v(t._s(s.user_name)+" Â· "+t._s(s.create_time))])])])}))],2)])},r=[],n=s(3675),a=s(4453);const o={name:"group",data(){return{user:{},group:[],loading:!0,global:a.Z,httping:!1,lang:{}}},created(){if(this.lang=this.$lang("group"),this.user=JSON.parse(localStorage.getItem("designer_user")),0==this.user.projects.substring(1).length)return this.group=[],void(this.loading=!1);this.getgroup()},computed:{isButtonDisabled(){const t=JSON.parse(localStorage.getItem("designer_user")),e=t.projects.substring(1),s=e.length>0?e.split(",").length:0,i=this.group.some((t=>t.max_projects<=s));return i}},methods:{getgroup(){this.user.projects=this.user.projects.substring(1),","==this.user.projects[0]&&(this.user.projects=this.user.projects.substring(1)),this.$ajax.get("/group/list/?ids="+this.user.projects+"&createrId="+this.user.id).then((t=>{this.group=t.map((t=>(t.create_time=n.Z.time("y-m-d",1e3*t.create_time),t.loading=!0,t))),this.$nextTick((()=>{let t=document.querySelectorAll(".project_cover");t.forEach(((t,e)=>{let s=new Image;s.onload=()=>{this.group[e].loading=!1,s.width>s.height?t.classList.add("row"):t.classList.add("col")},s.src=t.src})),this.loading=!1}))}))},share(t){this.group.map((e=>{e.id==t&&this.$copy(t,e.group_name)}))},rename(t){let e=this;e.$prompt(e.lang.tips2,e.lang.tips1,{inputPattern:/\S/,inputErrorMessage:e.lang.tips5,closeOnPressEscape:!1,closeOnClickModal:!1,cancelButtonText:e.lang.tips3,confirmButtonText:e.lang.tips4,beforeClose(s,i,r){if("confirm"==s){if(e.httping)return;e.httping=!0,e.$ajax.post("/group/rename",{id:t,name:i.inputValue}).then((s=>{e.$message.success("success"),e.group.map((e=>{e.id==t&&(e.group_name=i.inputValue)})),r(),setTimeout((()=>{e.httping=!1}),300)}))}else r()}}).catch((()=>{}))},del(t){let e=this;this.$confirm(e.lang.tips7,e.lang.tips6,{type:"warning",closeOnPressEscape:!1,closeOnClickModal:!1,cancelButtonText:e.lang.tips3,confirmButtonText:e.lang.tips4,beforeClose(s,i,r){if("confirm"==s){if(e.httping)return;e.httping=!0;let s=0;e.group.some(((e,i)=>{if(e.id==t)return s=i,!0})),e.$ajax.get("/group/del/?id="+t+"&createrId="+e.user.id).then((t=>{e.group.splice(s,1),e.$message.success("success"),r(),setTimeout((()=>{e.httping=!1}),300),e.updateUserProjects()}))}else r()}}).catch((()=>{}))},updateUserProjects(){const t=JSON.parse(localStorage.getItem("designer_user")),e=this.group.map((t=>t.id)).join(",");t.projects=","+e,localStorage.setItem("designer_user",JSON.stringify(t))},goProject(t){this.$router.push({path:"/list",query:{id:t}})},addProject(){let t=this;t.$prompt(t.lang.tips5,t.lang.add,{inputPattern:/\S/,inputErrorMessage:t.lang.tips5,closeOnPressEscape:!1,closeOnClickModal:!1,cancelButtonText:t.lang.tips3,confirmButtonText:t.lang.tips4,beforeClose(e,s,i){if("confirm"==e){if(t.httping)return;t.httping=!0,t.$ajax.post("/group/add",{name:s.inputValue,createrId:JSON.parse(localStorage.getItem("designer_user")).id}).then((e=>{i(),t.setGroup(e),t.$message.success("success"),setTimeout((()=>{t.httping=!1}),300)}))}else i()}}).catch((()=>{}))},setGroup(t){this.user.projects=t,localStorage.setItem("designer_user",JSON.stringify(this.user)),this.getgroup()}}},l=o;var c=s(3736),u=(0,c.Z)(l,i,r,!1,null,"7ea45f4b",null);const g=u.exports},3675:(t,e,s)=>{s.d(e,{Z:()=>r});const i={to2:t=>Number(t)<10?`0${t}`:String(t),time(t="y-m-d",e=null){let s=e?new Date(e):new Date;return t=t.replace("y",s.getFullYear()),t=t.replace("m",this.to2(s.getMonth()+1)),t=t.replace("d",this.to2(s.getDate())),t=t.replace("h",this.to2(s.getHours())),t=t.replace("i",this.to2(s.getMinutes())),t=t.replace("s",this.to2(s.getSeconds())),t=t.replace("w",s.getDay()),t},monthLength(t=null){let e=1*this.time("y",t),s=this.to2(1*this.time("m",t)+1),i=new Date(`${e}-${s}-01`).getTime()-864e5;return Number(this.time("d",i))},preMonthLenggth(t=null){let e=1*this.time("y",t),s=this.to2(1*this.time("m",t)),i=new Date(`${e}-${s}-01`).getTime()-864e5;return Number(this.time("d",i))},nextMonthLenggth(t=null){let e=1*this.time("y",t),s=this.to2(1*this.time("m",t)+2),i=new Date(`${e}-${s}-01`).getTime()-864e5;return Number(this.time("d",i))},monthFirst(t=null){let e=this.time("y-m",t)+"-01";return this.time("y-m-d",e)},monthLast(t=null){let e=1*this.time("y",t),s=this.to2(1*this.time("m",t)+1),i=new Date(`${e}-${s}-01`).getTime()-864e5;return this.time("y-m-d",i)},preMonthToday(t=null){let e=this.time("y",t),s=this.to2(1*this.time("m",t)-1),i=this.time("d",t);return this.time("y-m-d",`${e}-${s}-${i}`)},nextMonthToday(t=null){let e=this.time("y",t),s=this.to2(1*this.time("m",t)+1),i=this.time("d",t);return this.time("y-m-d",`${e}-${s}-${i}`)},timeout(t){},timeRemaining(t,e){return t-=parseInt((new Date).getTime()/1e3),this.unixToString(e,t)},unixToString(t,e){let s=parseInt(e/60/60/24),r=parseInt((e-86400*s)/3600),n=parseInt((e-86400*s-3600*r)/60),a=e-86400*s-3600*r-60*n;return t=t.replace("d",i.to2(i.low(s))),t=t.replace("h",i.to2(i.low(r))),t=t.replace("i",i.to2(i.low(n))),t=t.replace("s",i.to2(i.low(a))),t},low(t){return t<0?0:t},parse(t){return new Date(t)}},r=i}}]);
//# sourceMappingURL=808.9c7c8a47.js.map