"use strict";(self["webpackChunkdesigner"]=self["webpackChunkdesigner"]||[]).push([[671],{3671:(e,t,s)=>{s.r(t),s.d(t,{default:()=>g});var i=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"list"},[t("div",{staticClass:"list_head"},[t("div",{staticClass:"left-button"},[t("el-button",{staticStyle:{color:"#000000","border-width":"0px","background-color":"unset","font-weight":"500"},attrs:{type:"primary",size:"small",icon:"el-icon-arrow-left",plain:""},on:{click:e.goBack}},[e._v(e._s(e.lang.tips24))])],1),t("div",{staticClass:"design-style-preference"},[t("span",{staticClass:"text"},[e._v(e._s(e.lang.tips25))])]),t("div",{staticClass:"preference"},[t("div",{staticClass:"upload"},[t("el-select",{attrs:{placeholder:"All"},model:{value:e.selectedTag,callback:function(t){e.selectedTag=t},expression:"selectedTag"}},[t("el-option",{attrs:{value:""}},[e._v("All")]),e._l(e.tags,(function(e){return t("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})}))],2),t("el-button",{staticClass:"el-button",staticStyle:{background:"#345CA0",color:"white"},on:{click:e.saveSelectedImages}},[e._v(" "+e._s(e.lang.tips26)+" ")])],1)])]),t("div",{staticClass:"list_item"},[0===e.list.length?t("div",{staticClass:"nodata"},[t("el-empty",{attrs:{description:e.lang.nodata}})],1):e._e(),e._l(e.filteredList,(function(s,i){return t("div",{key:s.id,staticClass:"box"},[t("div",{staticClass:"main",class:{selected:e.isSelected(s)},on:{click:function(t){return e.toggleImageSelection(s)}}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:s.loading,expression:"item.loading"}],staticClass:"cover",attrs:{"element-loading-text":e.lang.loading+"..."}},[t("img",{staticClass:"project_cover",attrs:{src:"https://www.simplerevise.com/img/project/testimg/thumbnail/"+s.img_url+".jpg",alt:""}})])]),t("div",{staticClass:"title"},[t("p",[e._v(e._s(s.group_name))]),t("p",[e._v(e._s("null"!==s.tag_name?s.tag_name:"Untagged")+" Â· "+e._s(s.create_time))])])])}))],2)])},a=[],l=s(3675);s(4453);const n={data(){return{user:{},list:[],selectedOrganisation:"",selectedDesignType:"",selectedPreference:"",selectedTag:"",selectedImage:null,selectedImages:[],originalList:[],selectedImageIndex:-1,organisations:[{id:1,name:"Org 1"},{id:2,name:"Org 2"},{id:3,name:"Org 3"}],designTypes:[{id:1,name:"Design 1"},{id:2,name:"Design 2"},{id:3,name:"Design 3"}],preferences:[{id:1,name:"Preference 1"},{id:2,name:"Preference 2"},{id:3,name:"Preference 3"}],tags:[],loading:!1}},watch:{selectedTag:{handler(){this.filteredList()},immediate:!0}},created(){this.lang=this.$lang("board"),this.user=JSON.parse(localStorage.getItem("designer_user")),this.getList()},computed:{filteredList(){return""===this.selectedTag||"All"===this.selectedTag?(this.$nextTick((()=>{let e=document.querySelectorAll(".project_cover");e.forEach(((e,t)=>{let s=new Image;s.onload=()=>{this.list[t].loading=!1,s.width>s.height?e.classList.add("row"):e.classList.add("col")},s.src=e.src})),this.loading=!1})),this.originalList):(this.$nextTick((()=>{let e=document.querySelectorAll(".project_cover");e.forEach(((e,t)=>{let s=new Image;s.onload=()=>{this.list[t].loading=!1,s.width>s.height?e.classList.add("row"):e.classList.add("col")},s.src=e.src})),this.loading=!1})),this.originalList.filter((e=>e.tag_name===this.selectedTag)))},showAlertBox(){return this.selectedImages.length>0}},methods:{isSelected(e){return this.selectedImages.includes(e)},toggleImageSelection(e){this.isSelected(e)?this.selectedImages=this.selectedImages.filter((t=>t!==e)):this.selectedImages.push(e)},goProject(e){this.selectedImage=e},saveSelectedImages(){Promise.all(this.selectedImages.map((e=>{const t=e.img_url,s=this.user.id,i=e.title,a=e.create_time,l=e.status,n=e.pages,r=e.tag_name,o=this.$route.query.id;return this.$ajax.post("/group/save_public_img_to_own",{group_id:o,tag_name:r,img_url:t,id:s,title:i,status:l,pages:n,tag_name:r,create_time:a})}))).then((()=>{this.selectedImages=[],this.selectedImage=null,router.push({name:"public_gallery"})})).catch((e=>{console.error(e)}))},getList(){this.$ajax.get("/project/list_public_library").then((e=>{this.list=e.map((e=>(e.create_time=l.Z.time("y-m-d",1e3*e.create_time),e.loading=!0,e))),this.originalList=[...this.list],this.$ajax.get("/project/list_tags").then((e=>{this.tags=e})),this.$nextTick((()=>{let e=document.querySelectorAll(".project_cover");e.forEach(((e,t)=>{let s=new Image;s.onload=()=>{this.list[t].loading=!1,s.width>s.height?e.classList.add("row"):e.classList.add("col")},s.src=e.src})),this.loading=!1}))}))},del(e){let t=this;this.$confirm(t.lang.tips7,t.lang.tips6,{type:"warning",closeOnPressEscape:!1,closeOnClickModal:!1,cancelButtonText:t.lang.tips3,confirmButtonText:t.lang.tips4,beforeClose(s,i,a){if("confirm"==s){if(t.httping)return;t.httping=!0;let s=0;t.list.some(((t,i)=>{if(t.img_url==e)return s=i,!0})),t.$ajax.get("/group/del_gallery_img/?img_url="+e).then((e=>{t.list.splice(s,1),t.$message.success("success"),a(),setTimeout((()=>{t.httping=!1}),300)}))}else a()}}).catch((()=>{}))},handleUpload(e){},save(){},goBack(){this.$router.go(-1)},getDesignPreferenceLink(){return{name:"upload",query:this.$route.query}},goViewUserPreference(){return{name:"your_preference",query:this.$route.query}},goViewTagList(){return{name:"tag_list",query:this.$route.query}}}},r=n;var o=s(3736),c=(0,o.Z)(r,i,a,!1,null,"2ebb4bad",null);const g=c.exports},3675:(e,t,s)=>{s.d(t,{Z:()=>a});const i={to2:e=>Number(e)<10?`0${e}`:String(e),time(e="y-m-d",t=null){let s=t?new Date(t):new Date;return e=e.replace("y",s.getFullYear()),e=e.replace("m",this.to2(s.getMonth()+1)),e=e.replace("d",this.to2(s.getDate())),e=e.replace("h",this.to2(s.getHours())),e=e.replace("i",this.to2(s.getMinutes())),e=e.replace("s",this.to2(s.getSeconds())),e=e.replace("w",s.getDay()),e},monthLength(e=null){let t=1*this.time("y",e),s=this.to2(1*this.time("m",e)+1),i=new Date(`${t}-${s}-01`).getTime()-864e5;return Number(this.time("d",i))},preMonthLenggth(e=null){let t=1*this.time("y",e),s=this.to2(1*this.time("m",e)),i=new Date(`${t}-${s}-01`).getTime()-864e5;return Number(this.time("d",i))},nextMonthLenggth(e=null){let t=1*this.time("y",e),s=this.to2(1*this.time("m",e)+2),i=new Date(`${t}-${s}-01`).getTime()-864e5;return Number(this.time("d",i))},monthFirst(e=null){let t=this.time("y-m",e)+"-01";return this.time("y-m-d",t)},monthLast(e=null){let t=1*this.time("y",e),s=this.to2(1*this.time("m",e)+1),i=new Date(`${t}-${s}-01`).getTime()-864e5;return this.time("y-m-d",i)},preMonthToday(e=null){let t=this.time("y",e),s=this.to2(1*this.time("m",e)-1),i=this.time("d",e);return this.time("y-m-d",`${t}-${s}-${i}`)},nextMonthToday(e=null){let t=this.time("y",e),s=this.to2(1*this.time("m",e)+1),i=this.time("d",e);return this.time("y-m-d",`${t}-${s}-${i}`)},timeout(e){},timeRemaining(e,t){return e-=parseInt((new Date).getTime()/1e3),this.unixToString(t,e)},unixToString(e,t){let s=parseInt(t/60/60/24),a=parseInt((t-86400*s)/3600),l=parseInt((t-86400*s-3600*a)/60),n=t-86400*s-3600*a-60*l;return e=e.replace("d",i.to2(i.low(s))),e=e.replace("h",i.to2(i.low(a))),e=e.replace("i",i.to2(i.low(l))),e=e.replace("s",i.to2(i.low(n))),e},low(e){return e<0?0:e},parse(e){return new Date(e)}},a=i}}]);
//# sourceMappingURL=671.20fc4570.js.map